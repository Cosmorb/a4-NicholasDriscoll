<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Checkers Online</title>
	<link rel="stylesheet" href="style.css">
</head>
<body>
	<h1>Checkers Online</h1>
	
	<div id="auth">
		<h2>Login</h2>
		<form id="loginForm">
			<input type="text" id="username" placeholder="Username" required>
			<input type="password" id="password" placeholder="Password" required>
			<button type="submit">Login</button>
		</form>
		<p id="loginMessage"></p>
	</div>

	<div id="game" style="display:none;">
		<h2>Game</h2>
		<button id="createGame">Create Game</button>
		<input type="text" id="joinGameId" placeholder="Game ID">
		<button id="joinGame">Join Game</button>
		<p id="gameStatus"></p>
		<canvas id="board" width="480" height="480" style="border:1px solid #333;"></canvas>
	</div>

	<script>
		const $ = id => document.getElementById(id);

		$("loginForm").onsubmit = async e => {
			e.preventDefault();
			const username = $("username").value;
			const password = $("password").value;
			try {
				const res = await fetch("/auth/login", {
					method: "POST",
					headers: { "Content-Type": "application/json" },
					body: JSON.stringify({ username, password })
				});
				const data = await res.json();
				$("loginMessage").textContent = res.ok ? "Login successful!" : (data.error || "Login failed");
				if (res.ok) {
					$("auth").style.display = "none";
					$("game").style.display = "block";
				}
			} catch {
				$("loginMessage").textContent = "Server error";
			}
		};

		$("createGame").onclick = async () => {
			const res = await fetch("/api/game/create", { method: "POST" });
			const data = await res.json();
			$("gameStatus").textContent = "Game created. ID: " + data.gameId;
		};

		$("joinGame").onclick = async () => {
			const id = $("joinGameId").value;
			const res = await fetch("/api/game/join/" + id, { method: "POST" });
			const data = await res.json();
			$("gameStatus").textContent = res.ok ? "Joined game: " + data.gameId : (data.error || "Error joining game");
		};
	</script>
</body>
</html>
